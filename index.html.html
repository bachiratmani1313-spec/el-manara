// --- CERVEAU 1 : TRADUCTEUR (BIDIRECTIONNEL) ---
async function runTranslation() {
    const lang = document.getElementById('sourceLang').value;
    const text = document.getElementById('translateInput').value.trim();
    const outputDiv = document.getElementById('translateOutput');

    if(!text) { alert("الرجاء إدخال نص."); return; }

    outputDiv.innerHTML = '<span style="color:var(--neon-green)">جاري الاتصال...</span>';

    try {
        // LOGIQUE INVERSIBLE :
        // Si la source est Arabe ('ar'), on traduit vers Français ('fr').
        // Sinon, on traduit vers Arabe ('ar').
        let targetLanguage = "ar";
        if (lang === "ar") {
            targetLanguage = "fr";
        }

        const apiUrl = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${lang}|${targetLanguage}`;
        
        const response = await fetch(apiUrl);
        if(!response.ok) throw new Error("Réponse API invalide");
        const data = await response.json();

        if(data.responseStatus === 200) {
            const translatedText = data.responseData.translatedText;
            
            // On change la classe CSS pour que l'arabe s'affiche à droite et le français à gauche
            const direction = (targetLanguage === "ar") ? "rtl" : "ltr";
            outputDiv.innerHTML = `<div class="result-arabic" style="direction: ${direction}; text-align: ${direction === 'rtl' ? 'right' : 'left'};">${translatedText}</div>`;
        } else {
            outputDiv.innerHTML = `<div class="error-msg">Erreur : ${data.responseDetails || "Inconnue"}</div>`;
        }
    } catch (error) {
        console.error(error);
        outputDiv.innerHTML = `<div class="error-msg">Erreur de connexion.</div>`;
    }
}
